From ad224c6907e8a274f2679eae4c2e3085fdc7e8c8 Mon Sep 17 00:00:00 2001
From: Glenn Randers-Pehrson <glennrp at users.sourceforge.net>
Date: Sun, 22 Nov 2015 20:24:03 -0600
Subject: [PATCH] [libpng12] Fixed bug recently introduced in png_set_PLTE()
 that uses png_ptr

not info_ptr.
---
 pngset.c | 4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/pngset.c b/pngset.c
index 03a0dce..2e2285f 100644
--- a/pngset.c
+++ b/pngset.c
@@ -456,8 +456,8 @@ png_set_PLTE(png_structp png_ptr, png_infop info_ptr,
    if (png_ptr == NULL || info_ptr == NULL)
       return;
 
-   max_palette_length = (png_ptr->color_type == PNG_COLOR_TYPE_PALETTE) ?
-      (1 << png_ptr->bit_depth) : PNG_MAX_PALETTE_LENGTH;
+   max_palette_length = (info_ptr->color_type == PNG_COLOR_TYPE_PALETTE) ?
+      (1 << info_ptr->bit_depth) : PNG_MAX_PALETTE_LENGTH;
 
    if (num_palette < 0 || num_palette > (int) max_palette_length)
    {
